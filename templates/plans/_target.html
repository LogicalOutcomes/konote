{% load i18n %}
<td>
    <strong>{{ target.name }}</strong>
    {% if target.client_goal %}
    <br><small><strong>{% trans "In their words:" %}</strong> "{{ target.client_goal|truncatewords:50 }}"</small>
    {% else %}
    <br><small class="secondary"><em>{% trans "No participant words recorded yet" %}</em></small>
    {% endif %}
    {% if target.description %}
    <br><small class="secondary">{{ target.description|truncatewords:30 }}</small>
    {% endif %}
</td>
<td>
    {% if target.status == "default" %}
        <span class="badge badge-success">{% trans "Active" %}</span>
    {% elif target.status == "completed" %}
        <span class="badge badge-info">{% trans "Completed" %}</span>
    {% else %}
        <span class="badge badge-neutral">{% trans "Deactivated" %}</span>
    {% endif %}
</td>
<td>
    {% if target.achievement_status %}
        {% if target.achievement_status == "achieved" or target.achievement_status == "sustaining" %}
            <span class="badge badge-success">{{ target.get_achievement_status_display }}</span>
        {% elif target.achievement_status == "improving" %}
            <span class="badge badge-info">{{ target.get_achievement_status_display }}</span>
        {% elif target.achievement_status == "worsening" or target.achievement_status == "not_attainable" %}
            <span class="badge badge-warning">{{ target.get_achievement_status_display }}</span>
        {% else %}
            <span class="badge badge-neutral">{{ target.get_achievement_status_display }}</span>
        {% endif %}
        {% if target.achievement_status_source == "auto_computed" %}
            <small class="secondary">{% trans "(auto)" %}</small>
        {% endif %}
    {% else %}
        <small class="secondary">â€”</small>
    {% endif %}
</td>
<td>
    {% for metric in target.metrics.all %}
        <span class="badge badge-neutral" title="{{ metric.translated_definition|truncatewords:10 }}">{{ metric.translated_name }}</span>
    {% empty %}
        <small class="secondary">{% trans "None" %}</small>
    {% endfor %}
</td>
{% if can_edit %}
<td>
    <div class="actions-dropdown">
        <button class="outline small actions-dropdown-toggle" aria-expanded="false" aria-haspopup="true" aria-label="{% blocktrans with name=target.name %}Actions for {{ name }}{% endblocktrans %}">{% trans "Actions" %} &#9662;</button>
        <ul class="actions-dropdown-menu" role="menu" hidden>
            <li role="none"><a role="menuitem" href="{% url 'plans:target_edit' target_id=target.pk %}">{% trans "Edit" %}<small>{% blocktrans with target=term.target|default:"goal" %}Edit this {{ target }}{% endblocktrans %}</small></a></li>
            <li role="none"><a role="menuitem" href="#"
                hx-get="{% url 'plans:target_status' target_id=target.pk %}"
                hx-target="#target-{{ target.pk }}"
                hx-swap="innerHTML"
                hx-confirm="{% if target.status == 'default' %}{% trans 'Change the status of this goal? You can reactivate it later if needed.' %}{% else %}{% trans 'Reactivate this goal?' %}{% endif %}">{% if target.status == "default" %}{% trans "Mark Complete" %}{% elif target.status == "completed" %}{% trans "Reactivate" %}{% else %}{% trans "Reactivate" %}{% endif %}<small>{% if target.status == "default" %}{% trans "Change status to completed or deactivated" %}{% else %}{% trans "Set back to active" %}{% endif %}</small></a></li>
            <li class="dropdown-divider" role="separator"></li>
            <li role="none"><a role="menuitem" href="{% url 'plans:target_metrics' target_id=target.pk %}">{{ term.metric_plural|default:"Metrics" }}<small>{% trans "Choose how to measure progress" %}</small></a></li>
            <li role="none"><a role="menuitem" href="{% url 'plans:target_history' target_id=target.pk %}">{% trans "History" %}<small>{% trans "View past changes" %}</small></a></li>
        </ul>
    </div>
</td>
{% endif %}
